import{A as x,j as S,x as c}from"./index-Ce4miJWI.js";const f={appearance:{theme:"dark",terminalTheme:"default",fontFamily:"monospace",fontSize:14,ligatures:!0,opacity:100},keyboard:{layout:"qwerty",autoShow:!0,hapticFeedback:!0,hapticDuration:10,soundFeedback:!1,repeatDelay:500,repeatRate:30},terminal:{scrollback:1e3,cursorStyle:"block",cursorBlink:!0,bellStyle:"visual",copyOnSelect:!1,rightClickPaste:!0,shell:"bash"},sessions:{autoSave:!0,autoSaveInterval:30,restoreOnStartup:!0,maxSessions:10,confirmClose:!0,timeout:0,defaultName:"Terminal"},advanced:{debug:!1,telemetry:!1,wsReconnectAttempts:5,wsReconnectDelay:2e3}},j=x("settings",()=>{const a=S(y()),i=S(!1);let m=null;function y(){try{const t=localStorage.getItem("web-terminal-settings");if(t){const e=JSON.parse(t);return u(f,e)}}catch(t){console.error("Failed to load settings:",t)}return{...f}}function l(){try{localStorage.setItem("web-terminal-settings",JSON.stringify(a.value)),i.value=!1,console.log("Settings saved")}catch(t){console.error("Failed to save settings:",t)}}function v(t){a.value=u(a.value,t),i.value=!0,m&&clearTimeout(m),a.value.sessions.autoSave&&(m=setTimeout(()=>{l()},a.value.sessions.autoSaveInterval*1e3))}function g(){return{...a.value}}function h(t,e){return e?a.value[t][e]:a.value[t]}function b(t,e,r){r!==void 0?a.value[t][e]=r:a.value[t]=e,i.value=!0}function k(){a.value={...f},l()}function s(){const t=a.value.appearance.theme,e=document.documentElement;if(t==="auto"){const r=window.matchMedia("(prefers-color-scheme: dark)").matches;e.setAttribute("data-theme",r?"dark":"light")}else e.setAttribute("data-theme",t);e.style.setProperty("--terminal-font-family",a.value.appearance.fontFamily),e.style.setProperty("--terminal-font-size",`${a.value.appearance.fontSize}px`),e.style.setProperty("--terminal-opacity",`${a.value.appearance.opacity/100}`)}function w(){return JSON.stringify(a.value,null,2)}function I(t){try{const e=JSON.parse(t);return a.value=u(f,e),l(),s(),!0}catch(e){return console.error("Failed to import settings:",e),!1}}async function p(){return new Promise((t,e)=>{const r=indexedDB.open("WebTerminalDB",1);r.onerror=()=>e(r.error),r.onsuccess=()=>t(r.result),r.onupgradeneeded=n=>{const o=n.target.result;if(o.objectStoreNames.contains("sessions")||o.createObjectStore("sessions",{keyPath:"id"}),!o.objectStoreNames.contains("history")){const d=o.createObjectStore("history",{keyPath:"id",autoIncrement:!0});d.createIndex("sessionId","sessionId",{unique:!1}),d.createIndex("timestamp","timestamp",{unique:!1})}o.objectStoreNames.contains("shortcuts")||o.createObjectStore("shortcuts",{keyPath:"id"})}})}function u(t,e){const r={...t};for(const n in e)e[n]&&typeof e[n]=="object"&&!Array.isArray(e[n])?r[n]=u(r[n]||{},e[n]):r[n]=e[n];return r}return c(()=>a.value.appearance.theme,s),c(()=>a.value.appearance.fontFamily,s),c(()=>a.value.appearance.fontSize,s),c(()=>a.value.appearance.opacity,s),s(),p().catch(console.error),{settings:a,isDirty:i,getSettings:g,getSetting:h,setSetting:b,updateSettings:v,saveSettings:l,resetToDefaults:k,applyTheme:s,exportSettings:w,importSettings:I,initIndexedDB:p}});export{j as u};
