import{j as p,g as G,k as W,d as j,f as N,c as M,a as F,l as V,F as oe,h as se,m as _e,v as ye,p as ne,o as x,n as O,t as Y,i as Se,q as ge,s as we,x as q,b as o,w as n,r as b,y as ke,e as T,z as be}from"./index-D0SS_5bE.js";import{u as H}from"./sessions-ITFIA03a.js";import{_ as J}from"./_plugin-vue_export-helper-DlAUqK2U.js";import{u as Te}from"./settings-odx9OU9T.js";import{V as ae}from"./VirtualKeyboard-1DwF5qlm.js";function ie(l={}){const{swipeThreshold:s=50,longPressDelay:a=500}=l,m=p(0),u=p(0),h=p(0),v=p(0),y=p(0),S=p(0),f=p(!1),g=p(0);let w=null,C=0,L=1,i=null;function $(r){if(r.touches.length===1)m.value=r.touches[0].clientX,u.value=r.touches[0].clientY,y.value=Date.now(),l.onLongPress&&(w=setTimeout(()=>{l.onLongPress?.(r)},a)),l.onPullToRefresh&&window.scrollY===0&&(f.value=!0);else if(r.touches.length===2&&l.onPinch){const k=r.touches[0].clientX-r.touches[1].clientX,E=r.touches[0].clientY-r.touches[1].clientY;C=Math.sqrt(k*k+E*E)}}function t(r){if(w&&(clearTimeout(w),w=null),r.touches.length===1){if(h.value=r.touches[0].clientX,v.value=r.touches[0].clientY,f.value&&l.onPullToRefresh){const k=v.value-u.value;k>0&&(g.value=Math.min(k,150),r.preventDefault(),i&&(i.style.transform=`translateY(${g.value*.5}px)`,i.style.transition="none"))}}else if(r.touches.length===2&&l.onPinch&&C>0){const k=r.touches[0].clientX-r.touches[1].clientX,E=r.touches[0].clientY-r.touches[1].clientY,P=Math.sqrt(k*k+E*E)/C;Math.abs(P-L)>.01&&(L=P,l.onPinch(P))}}function _(r){w&&(clearTimeout(w),w=null);const k=Date.now(),E=k-y.value;if(l.onDoubleTap){const I=k-S.value;if(I<300&&I>0){l.onDoubleTap(),S.value=0;return}S.value=k}if(f.value&&l.onPullToRefresh){f.value=!1,i&&(i.style.transition="transform 0.3s ease",i.style.transform="translateY(0)"),g.value>80?l.onPullToRefresh().then(()=>{g.value=0}):g.value=0;return}if(E<300){const I=h.value-m.value,P=v.value-u.value,X=Math.abs(I),B=Math.abs(P);(X>s||B>s)&&(X>B?I>s&&l.onSwipeRight?l.onSwipeRight():I<-s&&l.onSwipeLeft&&l.onSwipeLeft():P>s&&l.onSwipeDown?l.onSwipeDown():P<-s&&l.onSwipeUp&&l.onSwipeUp())}C=0,L=1}function c(){w&&(clearTimeout(w),w=null),f.value=!1,g.value=0,C=0,L=1,i&&(i.style.transform="translateY(0)")}function D(r){r.preventDefault()}function A(r){i=r||l.element||document.body,i&&(i.addEventListener("touchstart",$,{passive:!1}),i.addEventListener("touchmove",t,{passive:!1}),i.addEventListener("touchend",_,{passive:!1}),i.addEventListener("touchcancel",c,{passive:!1}),i.addEventListener("gesturestart",D,{passive:!1}))}function U(){i&&(i.removeEventListener("touchstart",$),i.removeEventListener("touchmove",t),i.removeEventListener("touchend",_),i.removeEventListener("touchcancel",c),i.removeEventListener("gesturestart",D)),w&&clearTimeout(w)}return G(()=>{!i&&l.element&&A(l.element)}),W(()=>{U()}),{setup:A,cleanup:U,isPulling:f,pullDistance:g,touchStartX:m,touchStartY:u,touchEndX:h,touchEndY:v}}const xe={class:"session-tabs"},Ce=["onClick"],De=["onDblclick"],Ke=["onClick","title"],Le={key:0,class:"rename-dialog"},Ee=j({__name:"SessionTabs",setup(l){const s=H(),a=N(()=>s.sessions),m=N(()=>s.activeSessionId),u=p(null),h=p(""),v=p();async function y(){try{await s.createSession()}catch(t){console.error("Failed to create session:",t)}}function S(t){s.switchSession(t)}async function f(t){confirm("Close this session?")&&await s.closeSession(t)}async function g(t){u.value=t,h.value=t.name,await ge(),v.value?.select()}async function w(){u.value&&h.value.trim()&&(await s.renameSession(u.value.id,h.value.trim()),C())}function C(){u.value=null,h.value=""}function L(t){if(t.ctrlKey&&t.shiftKey&&t.key==="T"&&(t.preventDefault(),y()),t.ctrlKey&&t.key==="Tab"&&!t.shiftKey){t.preventDefault();const c=(a.value.findIndex(D=>D.id===m.value)+1)%a.value.length;a.value[c]&&S(a.value[c].id)}if(t.ctrlKey&&t.shiftKey&&t.key==="Tab"){t.preventDefault();const _=a.value.findIndex(D=>D.id===m.value),c=_===0?a.value.length-1:_-1;a.value[c]&&S(a.value[c].id)}t.ctrlKey&&t.key==="w"&&(t.preventDefault(),m.value&&f(m.value))}const i=p(),$=ie({onSwipeLeft:()=>{const _=(a.value.findIndex(c=>c.id===m.value)+1)%a.value.length;a.value[_]&&S(a.value[_].id)},onSwipeRight:()=>{const t=a.value.findIndex(c=>c.id===m.value),_=t===0?a.value.length-1:t-1;a.value[_]&&S(a.value[_].id)},swipeThreshold:50});return G(()=>{document.addEventListener("keydown",L),i.value&&$.setup(i.value)}),W(()=>{document.removeEventListener("keydown",L),$.cleanup()}),(t,_)=>(x(),M("div",xe,[F("div",{class:"tabs-container",ref_key:"tabsContainer",ref:i},[(x(!0),M(oe,null,se(a.value,c=>(x(),M("div",{key:c.id,class:O(["tab",{active:c.id===m.value}]),onClick:D=>S(c.id)},[F("span",{class:"tab-name",onDblclick:D=>g(c)},Y(c.name),41,De),F("button",{class:"close-btn",onClick:Se(D=>f(c.id),["stop"]),title:"Close "+c.name}," Ã— ",8,Ke)],10,Ce))),128)),F("button",{class:"tab add-tab",onClick:y,title:"New Session (Ctrl+Shift+T)"}," + ")],512),u.value?(x(),M("div",Le,[_e(F("input",{"onUpdate:modelValue":_[0]||(_[0]=c=>h.value=c),onKeyup:[ne(w,["enter"]),ne(C,["esc"])],ref_key:"renameInput",ref:v,placeholder:"Session name"},null,544),[[ye,h.value]])])):V("",!0)]))}}),Ie=J(Ee,[["__scopeId","data-v-5efed6d5"]]),Pe={class:"terminal-toolbar"},Me=["src"],ze={key:1,class:"no-session"},$e=j({__name:"TerminalFrame",props:{session:{}},setup(l){const s=l,a=H(),m=Te(),u=p(),h=p(!1),v=p(!1),y=p(1),S=p(!1),f=p(14),g=p("monokai"),w=[{id:"monokai",name:"Monokai",description:"Dark theme with vibrant colors"},{id:"solarized-dark",name:"Solarized Dark",description:"Popular dark theme"},{id:"solarized-light",name:"Solarized Light",description:"Light theme with good contrast"},{id:"dracula",name:"Dracula",description:"Dark theme with purple accents"},{id:"gruvbox",name:"Gruvbox",description:"Retro groove dark theme"},{id:"nord",name:"Nord",description:"Arctic, north-bluish theme"},{id:"one-dark",name:"One Dark",description:"Atom One Dark theme"},{id:"material",name:"Material",description:"Material Design theme"},{id:"tomorrow-night",name:"Tomorrow Night",description:"Tomorrow Night theme"},{id:"ayu",name:"Ayu",description:"Modern theme with vibrant colors"},{id:"tokyo-night",name:"Tokyo Night",description:"Clean, dark theme"},{id:"catppuccin",name:"Catppuccin",description:"Soothing pastel theme"}],C=N(()=>s.session?a.getSessionUrl(s.session.id):""),L=N(()=>"ontouchstart"in window||navigator.maxTouchPoints>0),i=N(()=>s.session?s.session.status==="active"?"success":"error":"grey"),$=N(()=>({fontSize:`${f.value}px`,transform:`scale(${y.value})`,transformOrigin:"top left"}));function t(){console.log("Terminal iframe loaded for session:",s.session?.id),X(),k()}function _(){a.createSession()}function c(){h.value=!h.value}function D(){document.fullscreenElement?(document.exitFullscreen(),S.value=!1):(u.value?.requestFullscreen(),S.value=!0)}function A(){f.value<24&&(f.value+=2,m.updateSetting("terminal.fontSize",f.value))}function U(){f.value>10&&(f.value-=2,m.updateSetting("terminal.fontSize",f.value))}function r(d){g.value=d.id,m.updateSetting("terminal.theme",d.id),k(),v.value=!1}function k(){const d=u.value?.querySelector("iframe");d&&d.contentWindow&&console.log("Applying theme:",g.value)}function E(){s.session&&a.reloadSession(s.session.id)}function I(d){const e=u.value?.querySelector("iframe");e&&e.contentWindow&&e.contentWindow.postMessage({type:"keypress",key:d.key,code:d.code,ctrlKey:d.ctrlKey,altKey:d.altKey,shiftKey:d.shiftKey,metaKey:d.metaKey},"*")}const P=ie({onPinch:d=>{u.value?.querySelector("iframe")&&(y.value=Math.min(Math.max(.5,y.value*d),3))},onDoubleTap:()=>{y.value=1},onLongPress:d=>{B()},onPullToRefresh:async()=>{s.session&&await a.reloadSession(s.session.id)}});function X(){!u.value||!L.value||P.setup(u.value)}function B(d){console.log("Long press detected - would show context menu")}we(()=>s.session,()=>{s.session&&(y.value=1)});function Q(){const d=u.value?.querySelector("iframe");d&&(d.style.height="0",setTimeout(()=>{d.style.height="100%"},0))}return G(()=>{window.addEventListener("resize",Q),X(),f.value=m.getSetting("terminal.fontSize",14),g.value=m.getSetting("terminal.theme","monokai"),document.addEventListener("fullscreenchange",()=>{S.value=!!document.fullscreenElement})}),W(()=>{window.removeEventListener("resize",Q)}),(d,e)=>{const R=b("v-tooltip"),z=b("v-btn"),Z=b("v-chip"),le=b("v-btn-group"),ee=b("v-spacer"),te=b("v-icon"),re=b("v-card-title"),ue=b("v-list-item-title"),ce=b("v-list-item-subtitle"),de=b("v-list-item"),ve=b("v-list"),fe=b("v-card-text"),me=b("v-card-actions"),pe=b("v-card"),he=b("v-dialog");return x(),M("div",{class:O(["terminal-frame",{fullscreen:S.value}]),ref_key:"terminalContainer",ref:u},[F("div",Pe,[o(le,{density:"compact",variant:"outlined"},{default:n(()=>[o(z,{onClick:D,icon:S.value?"mdi-fullscreen-exit":"mdi-fullscreen"},{default:n(()=>[o(R,{activator:"parent",location:"bottom"},{default:n(()=>[T(Y(S.value?"Exit Fullscreen":"Fullscreen"),1)]),_:1})]),_:1},8,["icon"]),o(z,{onClick:e[0]||(e[0]=K=>v.value=!0),icon:"mdi-palette"},{default:n(()=>[o(R,{activator:"parent",location:"bottom"},{default:n(()=>e[4]||(e[4]=[T("Theme",-1)])),_:1,__:[4]})]),_:1}),o(z,{onClick:U,icon:"mdi-minus",disabled:f.value<=10},{default:n(()=>[o(R,{activator:"parent",location:"bottom"},{default:n(()=>e[5]||(e[5]=[T("Decrease Font",-1)])),_:1,__:[5]})]),_:1},8,["disabled"]),o(Z,{size:"small",class:"mx-1"},{default:n(()=>[T(Y(f.value)+"px",1)]),_:1}),o(z,{onClick:A,icon:"mdi-plus",disabled:f.value>=24},{default:n(()=>[o(R,{activator:"parent",location:"bottom"},{default:n(()=>e[6]||(e[6]=[T("Increase Font",-1)])),_:1,__:[6]})]),_:1},8,["disabled"]),o(z,{onClick:E,icon:"mdi-refresh"},{default:n(()=>[o(R,{activator:"parent",location:"bottom"},{default:n(()=>e[7]||(e[7]=[T("Refresh",-1)])),_:1,__:[7]})]),_:1})]),_:1}),o(ee),o(Z,{size:"small",color:i.value},{default:n(()=>[T(Y(d.session?.name||"No Session"),1)]),_:1},8,["color"])]),C.value&&d.session?(x(),M("iframe",{src:C.value,key:d.session.id,class:O(["gotty-iframe",{[`theme-${g.value}`]:!0}]),style:ke($.value),onLoad:t,allow:"clipboard-write",frameborder:"0"},null,46,Me)):(x(),M("div",ze,[o(te,{size:"64",color:"grey"},{default:n(()=>e[8]||(e[8]=[T("mdi-console",-1)])),_:1,__:[8]}),e[10]||(e[10]=F("p",null,"No session selected",-1)),o(z,{color:"primary",onClick:_},{default:n(()=>e[9]||(e[9]=[T(" Create New Session ",-1)])),_:1,__:[9]})])),L.value&&!h.value?(x(),q(z,{key:2,class:"keyboard-toggle",fab:"",color:"primary",onClick:c,icon:"mdi-keyboard"},{default:n(()=>[o(R,{activator:"parent",location:"top"},{default:n(()=>e[11]||(e[11]=[T("Show Keyboard",-1)])),_:1,__:[11]})]),_:1})):V("",!0),h.value?(x(),q(ae,{key:3,onKeypress:I,onClose:e[1]||(e[1]=K=>h.value=!1)})):V("",!0),o(he,{modelValue:v.value,"onUpdate:modelValue":e[3]||(e[3]=K=>v.value=K),"max-width":"500"},{default:n(()=>[o(pe,null,{default:n(()=>[o(re,null,{default:n(()=>e[12]||(e[12]=[T("Select Terminal Theme",-1)])),_:1,__:[12]}),o(fe,null,{default:n(()=>[o(ve,null,{default:n(()=>[(x(),M(oe,null,se(w,K=>o(de,{key:K.id,onClick:Ye=>r(K),active:g.value===K.id},{append:n(()=>[g.value===K.id?(x(),q(te,{key:0,color:"primary"},{default:n(()=>e[13]||(e[13]=[T(" mdi-check ",-1)])),_:1,__:[13]})):V("",!0)]),default:n(()=>[o(ue,null,{default:n(()=>[T(Y(K.name),1)]),_:2},1024),o(ce,null,{default:n(()=>[T(Y(K.description),1)]),_:2},1024)]),_:2},1032,["onClick","active"])),64))]),_:1})]),_:1}),o(me,null,{default:n(()=>[o(ee),o(z,{variant:"text",onClick:e[2]||(e[2]=K=>v.value=!1)},{default:n(()=>e[14]||(e[14]=[T("Close",-1)])),_:1,__:[14]})]),_:1})]),_:1})]),_:1},8,["modelValue"])],2)}}}),Fe=J($e,[["__scopeId","data-v-8d847f38"]]),Ne={class:"session-view"},Re=j({__name:"SessionView",setup(l){const s=be(),a=H(),m=p(!1),u=N(()=>{const v=s.params.id;return a.sessions.find(y=>y.id===v)});G(async()=>{const v=s.params.id;if(v){await a.setActiveSession(v);const y=/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent);m.value=y}});function h(v){u.value&&a.sendKeyToSession(u.value.id,v)}return(v,y)=>(x(),M("div",Ne,[o(Ie),u.value?(x(),q(Fe,{key:0,session:u.value},null,8,["session"])):V("",!0),m.value?(x(),q(ae,{key:1,onKeyPress:h})):V("",!0)]))}}),Be=J(Re,[["__scopeId","data-v-87bed389"]]);export{Be as default};
